<!-- tbot_web/templates/holdings.html -->
<!-- Jinja2 page for managing ETF config, float %, tax %, payroll %, rebalancing, and status view. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Holdings Management</title>
    <link rel="stylesheet" type="text/css" href="/static/css/pages/holdings.css">
    <script src="/static/js/holdings.js" defer></script>
</head>
<body>
    <main class="holdings-container">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="flash-messages">
            {% for message in messages %}
            <div class="flash-message">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <div class="config-section">
            <h2>Holdings Configuration</h2>
            <form id="holdings-config-form">
                <label for="HOLDINGS_FLOAT_TARGET_PCT">Float Target %</label>
                <input type="number" step="0.1" id="HOLDINGS_FLOAT_TARGET_PCT" name="HOLDINGS_FLOAT_TARGET_PCT" autocomplete="off" required>

                <label for="HOLDINGS_TAX_RESERVE_PCT">Tax Reserve %</label>
                <input type="number" step="0.1" id="HOLDINGS_TAX_RESERVE_PCT" name="HOLDINGS_TAX_RESERVE_PCT" autocomplete="off" required>

                <label for="HOLDINGS_PAYROLL_PCT">Payroll %</label>
                <input type="number" step="0.1" id="HOLDINGS_PAYROLL_PCT" name="HOLDINGS_PAYROLL_PCT" autocomplete="off" required>

                <label for="HOLDINGS_REBALANCE_INTERVAL">Rebalance Interval (months)</label>
                <select id="HOLDINGS_REBALANCE_INTERVAL" name="HOLDINGS_REBALANCE_INTERVAL">
                    <option value="3">3</option>
                    <option value="6">6</option>
                    <option value="12">12</option>
                </select>

                <button type="submit">Save Settings</button>
            </form>
        </div>

        <hr>

        <div class="etf-list-section">
            <h2>ETF Allocation</h2>
            <table id="etf-allocation-table">
                <thead>
                    <tr>
                        <th>Symbol</th>
                        <th>Allocation %</th>
                        <th>Purchase Price</th>
                        <th>Units</th>
                        <th>Market Price</th>
                        <th>Market Value</th>
                        <th>Unrealized P/L</th>
                        <th>Total Gain/Loss</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="etf-table-body">
                    <!-- Rows dynamically populated by JS -->
                </tbody>
            </table>
            <button id="add-etf-btn">Add ETF</button>
        </div>

        <hr>

        <div class="status-section">
            <h2>Holdings Status</h2>
            <div id="holdings-status">
                <p><strong>Account Value:</strong> <span id="account_value">--</span></p>
                <p><strong>Cash:</strong> <span id="cash">--</span></p>
                <p><strong>Next Rebalance Due:</strong> <span id="next_rebalance_due">--</span></p>
            </div>
        </div>

        <hr>

        <div class="controls">
            <button id="trigger-rebalance-btn">Trigger Rebalance</button>
        </div>
    </main>
</body>
</html>
